<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Locação – Backdrop & Boxtruss (Interno)</title>
  <style>
    :root{
      --bg:#0b0b0c; --card:#18181b; --muted:#a1a1aa; --text:#fff; --line:#2b2b30; --accent:#10b981;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text)}
    .wrap{max-width:1000px;margin:0 auto;padding:24px;display:grid;gap:24px}
    header{display:flex;justify-content:space-between;align-items:flex-start;gap:16px}
    h1{font-size:22px;margin:0}
    .muted{color:var(--muted)}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px}
    label{font-size:13px;margin-bottom:6px;display:block}
    input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid var(--line);background:#111114;color:var(--text)}
    .grid{display:grid;gap:12px}
    .cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .row{display:flex;gap:8px;align-items:center}
    .btn{padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:#fff;color:#000;font-weight:600;cursor:pointer}
    .btn-accent{background:var(--accent);color:#000;border:none}
    .btn-ghost{background:#111114;color:#fff}
    .btn-small{padding:8px 10px;font-size:12px}
    .list{list-style:none;padding:0;margin:0;display:grid;gap:6px}
    .k{font-size:13px}
    .val{font-weight:700}
    hr{border:none;border-top:1px solid var(--line);margin:12px 0}
    .tiny{font-size:11px;color:var(--muted)}
    @media (max-width:760px){ .cols-2,.cols-3{grid-template-columns:1fr} header{flex-direction:column;align-items:flex-start} }
    @media print { .no-print{display:none} .print-block{display:block} body{background:#fff;color:#000} .card{border:none} }
    .print-block{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Calculadora de Locação – Backdrop & Boxtruss</h1>
        <div class="muted k">Até 4 dias sem alteração de valor • Válido para serviços no município do Rio de Janeiro – RJ</div>
      </div>
      <div class="muted k">vHTML/JS 1.0</div>
    </header>

    <div class="row no-print" style="gap:10px;flex-wrap:wrap">
      <button class="btn" onclick="document.getElementById('texto-cliente').scrollIntoView({behavior:'smooth'})">Ir para Texto do Cliente</button>
      <button class="btn btn-accent" onclick="gerarPDF()">Gerar PDF</button>
    </div>

    <section class="grid cols-2">
      <div class="card grid" id="dados">
        <h2 style="margin:0 0 8px 0;font-size:18px">Dados do painel</h2>

        <div>
          <label>Tipo</label>
          <select id="tipo">
            <option value="boxtruss_aparente">Boxtruss com Estrutura Aparente</option>
            <option value="boxtruss_envelopado">Boxtruss Envelopado (lona +40cm x +20cm)</option>
            <option value="metalon">Backdrop em Metalon (tipo caixa)</option>
          </select>
        </div>

        <div class="grid cols-2">
          <div>
            <label>Largura (m)</label>
            <input id="largura" type="number" step="0.01" value="4">
          </div>
          <div>
            <label>Altura (m)</label>
            <input id="altura" type="number" step="0.01" value="3">
          </div>
        </div>
        <div id="exemploLabel" class="tiny"></div>

        <!-- Tamanhos rápidos -->
        <div>
          <div style="font-weight:600;font-size:13px;margin-bottom:6px">Tamanhos rápidos</div>
          <div class="grid cols-3">
            <button class="btn btn-ghost btn-small" onclick="setSize(2,2)">2,00×2,00 m</button>
            <button class="btn btn-ghost btn-small" onclick="setSize(3,2)">3,00×2,00 m</button>
            <button class="btn btn-ghost btn-small" onclick="setSize(3,3)">3,00×3,00 m</button>
            <button class="btn btn-ghost btn-small" onclick="setSize(4,3)">4,00×3,00 m</button>
            <button class="btn btn-ghost btn-small" onclick="setSize(5,3)">5,00×3,00 m</button>
            <button class="btn btn-ghost btn-small" onclick="setSize(6,3)">6,00×3,00 m</button>
          </div>
          <div class="tiny" style="margin-top:4px">Clique para preencher largura/altura automaticamente.</div>
        </div>

        <div class="grid cols-3">
          <div>
            <label>Dias de locação</label>
            <input id="dias" type="number" min="1" value="1">
            <div class="tiny">Até 4 dias: sem acréscimo.</div>
          </div>
          <div>
            <label>Iluminação Ribaltas LED (qtd)</label>
            <input id="iluminacaoQtd" type="number" min="0" value="0">
          </div>
          <div class="row" style="align-items:end">
            <label class="row" style="margin:0">
              <input id="duplaFace" type="checkbox"> Dupla face
            </label>
          </div>
        </div>

        <div class="grid cols-2">
          <div class="row">
            <label class="row" style="margin:0">
              <input id="foraHorario" type="checkbox"> Montagem/Desmontagem fora do horário
            </label>
          </div>
          <div>
            <label>Extra fora do horário (R$ fixo)</label>
            <input id="extraForaHorarioValor" type="number" step="1" value="300">
          </div>
        </div>

        <div class="tiny">Valores válidos para serviço realizado no município do Rio de Janeiro – RJ.</div>
      </div>

      <div class="card">
        <h2 style="margin:0 0 8px 0;font-size:18px">Tabela de custos (editável)</h2>
        <div class="grid cols-2">
          <div>
            <label>Banner (R$/m²)</label>
            <input id="bannerM2" type="number" step="0.01" value="60">
          </div>
          <div>
            <label>Banner Envelopado (R$/m²)</label>
            <input id="bannerM2Env" type="number" step="0.01" value="60">
          </div>
          <div>
            <label>Estrutura Boxtruss (R$/m)</label>
            <input id="boxtrussML" type="number" step="0.01" value="100">
          </div>
          <div>
            <label>Estrutura Metalon (R$/m)</label>
            <input id="metalonML" type="number" step="0.01" value="120">
          </div>
          <div>
            <label>Iluminação Ribalta LED (R$/un)</label>
            <input id="iluminacaoUnit" type="number" step="0.01" value="100">
          </div>
          <div>
            <label>Dupla face (x)</label>
            <input id="duplaFaceMult" type="number" step="0.1" value="2">
          </div>
          <div>
            <label>Impostos NF (%)</label>
            <input id="impostosPct" type="number" step="0.01" value="14">
          </div>
        </div>
      </div>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h2 style="margin:0 0 8px 0;font-size:18px">Resumo técnico</h2>
        <ul class="list k" id="resumo"></ul>
      </div>
      <div class="card">
        <h2 style="margin:0 0 8px 0;font-size:18px">Valores para proposta</h2>
        <div class="k" id="valores"></div>
        <div class="tiny" style="margin-top:8px">*Valores válidos para serviços realizados no município do Rio de Janeiro – RJ. Para outras cidades, consultar frete.</div>
      </div>
    </section>

    <section class="card" id="texto-cliente">
      <h2 style="margin:0 0 8px 0;font-size:18px">Texto rápido para enviar ao cliente</h2>
      <div class="muted k" style="margin-bottom:6px">Copie e cole no WhatsApp/E-mail. (Edite local/agenda conforme necessário.)</div>
      <textarea id="texto" rows="12" readonly></textarea>
    </section>

    <!-- Área invisível usada na impressão/PDF -->
    <div id="printArea" class="print-block">
      <div style="padding:24px;color:#111">
        <h1 style="margin:0 0 8px 0;font-size:22px">Proposta de Locação – Backdrop & Boxtruss</h1>
        <div style="font-size:12px;color:#444">Válida para serviços no município do Rio de Janeiro – RJ. Até 4 dias sem alteração de valor.</div>
        <hr>
        <div id="pdfInfo" style="font-size:13px"></div>
        <table style="width:100%;border-collapse:collapse;margin-top:8px;font-size:13px">
          <tbody id="pdfTabela"></tbody>
        </table>
        <hr>
        <div style="font-size:11px;line-height:1.5">
          <p><b>Observação:</b> Serviços realizados fora do horário comercial, aos finais de semana ou em feriados poderão ter taxa adicional. Quando aplicável, essa taxa será previamente discriminada na proposta, de acordo com a necessidade e a solicitação do cliente.</p>
          <p>Condições de pagamento: Pix, depósito, boleto (sujeito à aprovação), cartão (taxas), e cripto.</p>
        </div>
      </div>
    </div>

    <footer class="tiny">
      Regras: estrutura por metro linear; banner por m²; para painéis envelopados, a lona considera +40cm na largura e +20cm na altura; até 4 dias não alteram o valor; extra fixo de R$ 300 quando houver montagem ou desmontagem fora do horário comercial; impostos NF listados separadamente.
    </footer>
  </div>

  <script>
    // Helpers
    const $ = (id) => document.getElementById(id);
    const moeda = (v) => v.toLocaleString('pt-BR', {style:'currency', currency:'BRL'});
    const num = (el) => { const n = parseFloat(el.value.replace(',', '.')); return isFinite(n) ? Math.max(0, n) : 0; };

    function setSize(w,h){
      $('largura').value = w;
      $('altura').value = h;
      update();
    }

    function exemploLabel(){
      const tipo = $('tipo').value;
      const w = num($('largura'));
      const h = num($('altura'));
      if (tipo==='boxtruss_aparente' && w===4 && h===3) return '(Ex.: 4,00 × 3,00 m – ref. Proposta #137910)';
      if (tipo==='boxtruss_envelopado' && Math.abs(w-2.6)<1e-9 && Math.abs(h-2.3)<1e-9) return '(Ex.: 2,60 × 2,30 m envelopado – ref. #137906)';
      if (tipo==='metalon' && Math.abs(w-2.5)<1e-9 && Math.abs(h-2.3)<1e-9) return '(Ex.: 2,50 × 2,30 m metalon – ref. #137900/#137895)';
      return '';
    }

    function calcular(){
      const tipo = $('tipo').value;
      const w = num($('largura'));
      const h = num($('altura'));
      const dias = Math.max(1, parseInt($('dias').value || '1', 10));
      const iluminacaoQtd = Math.max(0, parseInt($('iluminacaoQtd').value || '0', 10));
      const duplaFace = $('duplaFace').checked;
      const foraHorario = $('foraHorario').checked;

      const bannerM2 = num($('bannerM2'));
      const bannerM2Env = num($('bannerM2Env'));
      const boxtrussML = num($('boxtrussML'));
      const metalonML = num($('metalonML'));
      const iluminacaoUnit = num($('iluminacaoUnit'));
      const duplaFaceMult = num($('duplaFaceMult'));
      const impostosPct = num($('impostosPct'))/100;
      const extraForaHorarioValor = num($('extraForaHorarioValor'));

      const perimetro = 2*(w+h);

      const isEnv = (tipo==='boxtruss_envelopado');
      const lonaW = isEnv ? w + 0.4 : w;
      const lonaH = isEnv ? h + 0.2 : h;

      const estruturaML = (tipo==='metalon') ? metalonML : boxtrussML;
      const bannerM2Rate = isEnv ? bannerM2Env : bannerM2;

      const bannerArea = lonaW * lonaH;
      const bannerCusto = bannerArea * bannerM2Rate * (duplaFace ? (duplaFaceMult||2) : 1);

      const estruturaCusto = perimetro * estruturaML;
      const iluminacaoCusto = iluminacaoQtd * iluminacaoUnit;

      const diasMult = 1; // até 4 dias sem acréscimo
      const baseServicos = (estruturaCusto + bannerCusto + iluminacaoCusto) * diasMult;

      const extraForaHorario = foraHorario ? extraForaHorarioValor : 0;

      const subtotal = baseServicos + extraForaHorario;
      const impostos = subtotal * impostosPct;
      const total = subtotal + impostos;

      return {
        tipo, w, h, dias, iluminacaoQtd, duplaFace, foraHorario,
        perimetro, lonaW, lonaH, bannerArea,
        estruturaCusto, bannerCusto, iluminacaoCusto,
        extraForaHorario, subtotal, impostos, total,
        impostosPct
      };
    }

    function render(){
      const c = calcular();
      $('exemploLabel').textContent = exemploLabel();

      // Resumo técnico
      $('resumo').innerHTML = `
        <li>Perímetro estrutural: <b class="val">${c.perimetro.toFixed(2)} m</b></li>
        <li>Lona (cálculo): <b class="val">${c.lonaW.toFixed(2)} m</b> × <b class="val">${c.lonaH.toFixed(2)} m</b> = <b class="val">${c.bannerArea.toFixed(2)} m²</b></li>
        <li>Estrutura: <b class="val">${moeda(c.estruturaCusto)}</b></li>
        <li>Banner ${c.duplaFace ? '(dupla face)' : ''}: <b class="val">${moeda(c.bannerCusto)}</b></li>
        <li>Iluminação Ribaltas LED: <b class="val">${moeda(c.iluminacaoCusto)}</b></li>
        ${c.foraHorario ? `<li>Extra fora do horário: <b class="val">${moeda(c.extraForaHorario)}</b></li>` : ''}
      `;

      // Valores para proposta
      $('valores').innerHTML = `
        <div class="row" style="justify-content:space-between"><span>Subtotal</span><span class="val">${moeda(c.subtotal)}</span></div>
        <div class="row" style="justify-content:space-between"><span>Impostos NF (${(c.impostosPct*100).toFixed(0)}%)</span><span class="val">${moeda(c.impostos)}</span></div>
        <hr>
        <div class="row" style="justify-content:space-between;font-size:18px"><span>Total</span><span class="val">${moeda(c.total)}</span></div>
      `;

      // Texto para WhatsApp/E-mail
      $('texto').value =
`LOCAÇÃO ${c.tipo === 'metalon' ? 'DE PAINEL BACKDROP (METALON)' : 'DE ESTRUTURA BOXTRUSS'}

Formato: ${c.w.toFixed(2)} x ${c.h.toFixed(2)} m${c.tipo==='boxtruss_envelopado' ? ' (painel envelopado)' : ''}${c.duplaFace ? ' – impressão dupla face' : ''}.
Iluminação: ${c.iluminacaoQtd > 0 ? c.iluminacaoQtd + ' Ribalta(s) LED' : 'não'}
Dias de locação: ${c.dias} (até 4 dias sem acréscimo)${c.foraHorario ? `
Extra: Montagem/Desmontagem fora do horário – ${moeda(c.extraForaHorario)}` : ''}

Subtotal: ${moeda(c.subtotal)}
Impostos NF (${(c.impostosPct*100).toFixed(0)}%): ${moeda(c.impostos)}
TOTAL: ${moeda(c.total)}

Valores válidos para serviço realizado no município do Rio de Janeiro – RJ. Instalação e retirada inclusas.

Observação: Serviços realizados fora do horário comercial, aos finais de semana ou em feriados poderão ter taxa adicional. Quando aplicável, essa taxa será previamente discriminada na proposta, de acordo com a necessidade e a solicitação do cliente.

Condições de pagamento: Pix, depósito, boleto (sujeito à aprovação), cartão (taxas), e cripto.`;

      // Preparar conteúdo do PDF
      $('pdfInfo').innerHTML = `
        <div><b>Tipo:</b> ${c.tipo === 'metalon' ? 'Backdrop (Metalon tipo caixa)' : (c.tipo === 'boxtruss_envelopado' ? 'Boxtruss envelopado' : 'Boxtruss aparente')}</div>
        <div><b>Formato:</b> ${c.w.toFixed(2)} × ${c.h.toFixed(2)} m ${c.tipo==='boxtruss_envelopado' ? '(envelopado)' : ''}${c.duplaFace ? ' – impressão dupla face' : ''}</div>
        <div><b>Iluminação:</b> ${c.iluminacaoQtd > 0 ? c.iluminacaoQtd + ' Ribalta(s) LED' : 'não'}</div>
        ${c.foraHorario ? `<div><b>Extra fora do horário:</b> ${moeda(c.extraForaHorario)}</div>` : ''}
      `;
      $('pdfTabela').innerHTML = `
        <tr><td><b>Estrutura</b></td><td style="text-align:right">${moeda(c.estruturaCusto)}</td></tr>
        <tr><td><b>Banner${c.duplaFace ? ' (dupla face)' : ''}</b></td><td style="text-align:right">${moeda(c.bannerCusto)}</td></tr>
        <tr><td><b>Iluminação</b></td><td style="text-align:right">${moeda(c.iluminacaoCusto)}</td></tr>
        ${c.foraHorario ? `<tr><td><b>Extra</b></td><td style="text-align:right">${moeda(c.extraForaHorario)}</td></tr>` : ''}
        <tr><td><b>Subtotal</b></td><td style="text-align:right">${moeda(c.subtotal)}</td></tr>
        <tr><td><b>Impostos NF ${(c.impostosPct*100).toFixed(0)}%</b></td><td style="text-align:right">${moeda(c.impostos)}</td></tr>
        <tr><td style="font-weight:700">Total</td><td style="text-align:right;font-weight:700">${moeda(c.total)}</td></tr>
      `;
    }

    function update(){ render(); }

    // Eventos
    ['tipo','largura','altura','dias','iluminacaoQtd','duplaFace','foraHorario','bannerM2','bannerM2Env','boxtrussML','metalonML','iluminacaoUnit','duplaFaceMult','impostosPct','extraForaHorarioValor']
      .forEach(id => $(id).addEventListener('input', update));

    function gerarPDF(){
      // Abre a janela de impressão
      window.print();
    }

    // Inicializa
    update();
  </script>
</body>
</html>
